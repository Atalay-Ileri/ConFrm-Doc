\begin{BVerbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8},fontsize=\footnotesize]
\PY{k+kn}{Definition} \PY{n}{equiv\PYZus{}state\PYZus{}for\PYZus{}principal} \PY{n}{u} \PY{n}{res0} \PY{n}{res1} \PY{o}{:=}
  \PY{k}{exists} \PY{n}{st0} \PY{n}{st1}\PY{o}{,}
    \PY{n}{equivalent\PYZus{}for\PYZus{}principal} \PY{n}{u} \PY{n}{st0} \PY{n}{st1} \PY{o}{/\PYZbs{}}
    \PY{o}{(}\PY{n}{res0} \PY{o}{=} \PY{n}{Crashed} \PY{n}{st0} \PY{o}{/\PYZbs{}} \PY{n}{res1} \PY{o}{=} \PY{n}{Crashed} \PY{n}{st1} \PY{o}{\PYZbs{}/}
     \PY{k}{exists} \PY{n}{v0} \PY{n}{v1}\PY{o}{,}
       \PY{n}{res0} \PY{o}{=} \PY{n}{Finished} \PY{n}{st0} \PY{n}{v0} \PY{o}{/\PYZbs{}}
\\[0.7\baselineskip]       \PY{n}{res1} \PY{o}{=} \PY{n}{Finished} \PY{n}{st1} \PY{n}{v1}\PY{o}{)}\PY{o}{.}
\PY{k+kn}{Definition} \PY{n}{state\PYZus{}noninterference} \PY{o}{`}\PY{o}{(}\PY{n}{p} \PY{o}{:} \PY{n}{proc} \PY{n}{T}\PY{o}{)} \PY{o}{:=}
  \PY{k}{forall} \PY{n}{viewer} \PY{n}{caller} \PY{n}{st0} \PY{n}{rand} \PY{n}{res0} \PY{n}{tr0} \PY{n}{st1}\PY{o}{,}
    \PY{n}{exec} \PY{n}{p} \PY{n}{caller} \PY{n}{st0} \PY{n}{rand} \PY{o}{=} \PY{n}{Some} \PY{o}{(}\PY{n}{res0}\PY{o}{,} \PY{n}{tr0}\PY{o}{)} \PY{o}{\PYZhy{}\PYZgt{}}
    \PY{n}{equivalent\PYZus{}for\PYZus{}principal} \PY{n}{viewer} \PY{n}{st0} \PY{n}{st1} \PY{o}{\PYZhy{}\PYZgt{}}
    \PY{k}{forall} \PY{n}{res1} \PY{n}{tr1}\PY{o}{,}
      \PY{n}{exec} \PY{n}{p} \PY{n}{caller} \PY{n}{st1} \PY{n}{rand} \PY{o}{=} \PY{n}{Some} \PY{o}{(}\PY{n}{res1}\PY{o}{,} \PY{n}{tr1}\PY{o}{)} \PY{o}{\PYZhy{}\PYZgt{}}
      \PY{n}{equiv\PYZus{}state\PYZus{}for\PYZus{}principal} \PY{n}{viewer} \PY{n}{res0} \PY{n}{res1}\PY{o}{.}
\end{BVerbatim}
